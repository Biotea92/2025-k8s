## PV/PVC, Deployment, Service, HPA

### PV/PVC

- 구조 

    ```
    Pod <-> PVC <-> PV
    ```

- PVC(PersistentVolumeClaim): Pod에서 필요한 스토리지를 요청하는 객체
- PV(PersistentVolume): 실제 저장소 자원
- `ReadWriteMany` 옵션은 여러 노드에서 동시연결 가능하게 해주는 옵션
- PVC와 PV는 Pod가 재시작하더라도 데이터가 유실되는 것을 방지하는 영속 저장소 역할
- hostPath, local  
    > hostPath  
    > - 노드의 로컬 디스크 경로를 직접 마운트
    > - 실습, 테스트용도의 임시 저장용도로 적합
    > - Pod 삭제 시 데이터도 삭제  
    > 
    > local
    > - 특정 노드의 디렉터리 경로를 지정
    > - nodeAffinity 필요
    > - 노드 장애 시 데이터 복구 어려움


### Deployment
- Pod와 ReplicaSet을 관리하는 상위 리소스
- 선언적으로 배포와 업데이트를 수행
- 상태 변화에 따라 자동으로 ReplicaSet과 Pod 업데이트
- strategy
    > RollingUpdate: 점진적 교체, 무중단 배포 가능
    > - maxUnavailable: 동시에 내려가는 Pod 수 비율
    > - maxSurge: 새로 추가되는 Pod 수 비율
    > 
    > Recreate: 기존 Pod 전부 종료 후 새로 배포

RollingUpdate 전략은 업데이트 중 두 버전이 동시에 호출 될 수 있다는 단점이 있다.

cf) Blue/Green 전략
- 두 버전을 동시에 운영하지 않는다.
- 리소스 사용량은 많지만 충돌 없다.

### Service

- Pod